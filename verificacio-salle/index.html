#importa llibreria missatges
Add-Type -AssemblyName "System.Windows.Forms"


######################

# Function to show a message box
function Show-MessageBox {
    [System.Windows.Forms.MessageBox]::Show("Has sigut infectat per un virus lassalllista", "Alert", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Warning)
}

Start-Sleep -Seconds 5
# Run multiple instances of message box sequentially (not as background jobs)
for ($i = 0; $i -lt 2; $i++) {
    Show-MessageBox
    Start-Sleep -Seconds 1
}
Start-Sleep -Seconds 5
for ($i = 0; $i -lt 3; $i++) {
    Show-MessageBox
    Start-Sleep -Seconds 1
}
Start-Sleep -Seconds 5
for ($i = 0; $i -lt 4; $i++) {
    Show-MessageBox
}
Start-Process "https://qr.carquinyolis.cat"
Start-Sleep -Seconds 5
for ($i = 0; $i -lt 5; $i++) {
    Show-MessageBox
}
Start-Sleep -Seconds 5
for ($i = 0; $i -lt 6; $i++) {
    Show-MessageBox
}
Start-Process "https://qr.carquinyolis.cat"
Start-Sleep -Seconds 5
for ($i = 0; $i -lt 10; $i++) {
    Show-MessageBox
}

######################

#espera una mica per si tarda a accedir
Start-Sleep -Seconds 10

#obra la disquetera si hi ha
try {
    $eject = New-Object -ComObject Shell.Application
    $eject.NameSpace("shell:::{645FF040-5081-101B-9F08-00AA002F954E}").Items() | ForEach-Object { $_.InvokeVerb('Eject') }
}
catch {
    Write-Host "No hi ha disquetera"
}

# Uncomment the line below if you want the computer to shut down after
#Stop-Computer
